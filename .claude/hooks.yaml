# ü™ù Claude Code Hooks Configuration
# ADR-008: Sistema Avan√ßado de Gest√£o de Contexto e Auto-Educa√ß√£o
#
# Hooks documentados em: .claude/memory/decisions/ADR-008-ADVANCED-CONTEXT.md
#
# Hooks dispon√≠veis:
# - PreCompact: Antes de auto-compactar contexto
# - SessionStart: Ao iniciar nova sess√£o
# - UserPromptSubmit: Antes de processar cada prompt do usu√°rio
# - ToolUse: Antes/depois de usar ferramentas
#
# Refer√™ncia: https://code.claude.com/docs/en/hooks.md

---

# üîÑ Hook 1: PreCompact - Salvar Contexto Cr√≠tico
# Trigger: Apenas auto-compact (95% capacidade)
# Objetivo: Salvar snapshot do contexto ANTES de compactar

- matcher: PreCompact
  trigger: auto  # Apenas auto-compact, n√£o manual
  hooks:
    - type: command
      command: .claude/scripts/bash/pre-compact-save-context.sh
      description: "üíæ Salva contexto cr√≠tico antes de auto-compact"

---

# üöÄ Hook 2: SessionStart - Auto-Restaura√ß√£o
# Trigger: Ap√≥s compacta√ß√£o
# Objetivo: Re-educar Claude automaticamente

- matcher: SessionStart
  trigger: compact  # Ap√≥s compactar
  hooks:
    - type: prompt
      system_prompt: |
        üîÑ **CONTEXTO RESTAURADO P√ìS-COMPACT**

        Voc√™ acabou de ser recompactado. IMPORTANTE - Re-eduque-se IMEDIATAMENTE:

        **1. Leia os seguintes arquivos (em paralelo):**
        - `.claude/memory/context-snapshots/` (√∫ltimo snapshot)
        - `CLAUDE.md` (regras fundamentais)
        - `.claude/memory/decisions/ADR-INDEX.md` (decis√µes cr√≠ticas)

        **2. Re-eduque-se sobre:**
        - √öltimas decis√µes t√©cnicas (ADRs recentes)
        - TODOs em andamento
        - Estado atual do projeto
        - √öltima sincroniza√ß√£o com template

        **3. Contexto do Projeto:**
        - Projeto: testing-odoo-15-sr (Odoo 15)
        - Template: Claude-especial (sincroniza√ß√£o dual)
        - Performance: Claude Max 20x (paraleliza√ß√£o m√°xima)
        - Workflow: Git anti-rebase, commits descritivos

        **4. Responda ao usu√°rio:**
        "‚úÖ Re-educado! [resumo conciso do contexto recuperado: √∫ltimos ADRs, TODOs ativos, branch atual]"

        **NUNCA esque√ßa:** ADR-006 (Sincroniza√ß√£o Dual) - TUDO gen√©rico vai para ambos repos!

---

# üìç Hook 3: UserPromptSubmit - Contexto Din√¢mico
# Trigger: Antes de CADA prompt do usu√°rio
# Objetivo: Injetar contexto atualizado automaticamente

- matcher: UserPromptSubmit
  hooks:
    - type: command
      command: .claude/scripts/bash/inject-dynamic-context.sh
      description: "üìç Injeta contexto din√¢mico (git branch, mudan√ßas, etc)"

---

# üéØ Configura√ß√µes Adicionais

# Desabilitar hooks espec√≠ficos (se necess√°rio):
# disabled_hooks:
#   - PreCompact
#   - SessionStart
#   - UserPromptSubmit

# Timeout para comandos (milissegundos):
command_timeout: 10000  # 10 segundos

# Modo verbose para debug:
verbose: false

---

# üìù Notas de Implementa√ß√£o
#
# Sprint 1 (ADR-008):
# ‚úÖ PreCompact hook - Salva ADRs, commits, TODOs
# ‚úÖ SessionStart hook - Re-educa√ß√£o autom√°tica
# ‚úÖ UserPromptSubmit hook - Contexto din√¢mico (branch, changes)
#
# Sprint 2 (Futuro):
# - Output Styles (odoo-expert, performance-guru, architect)
#
# Sprint 3 (Futuro):
# - @imports para CLAUDE.md modular
#
# √öltima atualiza√ß√£o: 2025-11-17
